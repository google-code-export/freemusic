{% extends "base.html" %}
{% block ueb %}/album/edit?id={{ album.id }}{% endblock %}
{% block content %}
<div id="album">
    <div class="header">
        <h2>{{ album.name }}</h2>
        <p class="info"><a title="Перейти на страницу исполнителя" href="/artist/{{ album.artist.id }}">{{ album.artist.name }}</a>{% if album.release_date %}, {{ album.release_date|date:"Y" }}{% endif %}</p>
    </div>
    <div class="block">
        <div id="tracklist">
            <table>
                <tbody>
                    {% for track in files.tracks %}{% ifequal track.content_type "audio/mp3" %}
                        <tr>
                            <td class="n">{{ forloop.counter }}.</td>
                            <td class="l"><a href="/track/{{ track.id }}">{% if track.song_title %}{{ track.song_title }}{% else %}{{ track.filename }}{% endif %}</a></td>
                            <td class="dl">{% if track.ogg_link %}<a class="ogg" href="{{ track.ogg_link }}">ogg</a>{% endif %}</td>
                            <td class="dl">{% if track.mp3_link %}<a class="mp3" href="{{ track.mp3_link }}">mp3</a>{% endif %}</td>
                            <td class="dur">{% if track.duration %}{{ track.duration }}{% endif %}</td>
                        </tr>
                    {% endifequal %}{% endfor %}
                </tbody>
            </table>
        </div>

        {% if album.cover_small %}<div id="coverart">
            <h3>Обложка</h3>
			<a href="{{ album.cover_large }}"><img src="{{ album.cover_small }}"/></a>
        </div>{% endif %}

        <div id="attachments">
            {% if files.other %}<h3>Файлы для скачивания</h3>
            <table class="classic">
                <tbody>
                    {% for file in files.other %}
                        <tr class="{% cycle odd,even as class %}">
                            <td>
                                <a href="/file/serve?id={{ file.id }}">{{ file.filename }}</a>
                            </td>
                            <!--
                            <td>{{ file.type }}</td>
                            -->
                            <td>
                                {% ifequal file.type "application/zip" %}
                                    <a href="{{ file.uri }}?torrent">.torrent</a>
                                {% endifequal %}
                            </td>
                            <td class="size">{{ file.size|filesizeformat}}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>{% endif %}
			{% if upload_url %}
				<h3>Добавление файла</h3>
				<form action="{{ upload_url }}" method="post" enctype="multipart/formdata">
					<div>
						<input type="file" name="file"/>
					</div>
					<div>
						<input type="submit" value="Добавить файл"/>
					</div>
				</form>
			{% endif %}
        </div>
    </div>
</div>
{% endblock %}
